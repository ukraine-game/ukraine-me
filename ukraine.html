<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –¢—Ä–∏–≤–æ–≥ –£–∫—Ä–∞—ó–Ω–∏ (XML API + Dev)</title>
    <style>
        /* =================================
        == CSS –°–¢–ò–õ–Ü (–ó–∞–ª–∏—à–∏–ª–∏—Å—è –±–µ–∑ –∑–º—ñ–Ω) 
        =================================
        */
        :root {
            --color-bg: #111111;
            --color-text: #F5F5F5;
            --color-red-danger: #CC0000;
            --color-red-dark: #800000;
            --color-black-light: #222222;
            --color-border: #444444;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç–∏ (—ñ–º—ñ—Ç–∞—Ü—ñ—è –∫–∞—Ä—Ç–∏ –£–∫—Ä–∞—ó–Ω–∏) */
        .map-container {
            width: 95%;
            max-width: 1100px;
            height: 700px;
            border: 2px solid var(--color-border);
            margin: 50px 0 20px 0;
            position: relative;
            background-color: var(--color-black-light);
            box-shadow: 0 0 20px rgba(204, 0, 0, 0.3);
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –û–ë–õ–ê–°–¢–ï–ô */
        .oblast {
            position: absolute;
            background-color: var(--color-black-light);
            border: 1px solid var(--color-border);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
            cursor: default;
            color: var(--color-text);
            font-weight: bold;
            font-size: 10px;
            line-height: 1.1;
            padding: 5px;
            box-sizing: border-box;
            border-radius: 2px;
            z-index: 10;
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏ */
        .alert {
            background-color: var(--color-red-danger) !important;
            border-color: var(--color-red-danger) !important;
            box-shadow: 0 0 15px var(--color-red-danger), 0 0 5px var(--color-red-danger) inset;
            animation: pulse-red 1s infinite alternate;
            color: white;
            z-index: 20; 
        }

        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è —Ç—Ä–∏–≤–æ–≥–∏ */
        @keyframes pulse-red {
            from { opacity: 1; }
            to { opacity: 0.8; }
        }

        /* =================================
        == –ö–ù–û–ü–ö–ê –†–û–ó–†–û–ë–ù–ò–ö–ê —Ç–∞ –Ü–ù–§–û 
        =================================
        */
        .info-panel {
             position: absolute;
             top: 10px;
             left: 10px;
             color: var(--color-red-danger);
             font-size: 12px;
             z-index: 100;
        }
        
        .dev-login-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            font-size: 10px;
            background-color: transparent;
            color: var(--color-red-dark);
            border: 1px solid var(--color-red-dark);
            cursor: pointer;
            border-radius: 3px;
            transition: background-color 0.3s, color 0.3s;
            z-index: 100;
        }

        .dev-login-btn:hover {
            background-color: var(--color-red-dark);
            color: var(--color-text);
        }

        /* =================================
        == –ú–ï–ù–Æ –†–û–ó–†–û–ë–ù–ò–ö–ê 
        =================================
        */
        .dev-menu {
            margin-top: 20px;
            padding: 20px;
            border: 2px solid var(--color-red-danger);
            background-color: var(--color-black-light);
            display: none; 
            width: 95%;
            max-width: 1100px;
            box-shadow: 0 0 15px rgba(204, 0, 0, 0.5);
        }

        .dev-menu h3 {
            color: var(--color-red-danger);
            text-align: center;
            margin-top: 0;
            border-bottom: 1px solid var(--color-red-dark);
            padding-bottom: 10px;
        }

        .dev-menu .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .dev-menu button {
            background-color: var(--color-red-dark);
            color: var(--color-text);
            border: none;
            padding: 5px 10px;
            margin: 3px;
            cursor: pointer;
            border-radius: 3px;
            transition: background-color 0.3s;
            font-size: 11px;
        }

        .dev-menu button.active-alert {
            background-color: var(--color-red-danger);
            box-shadow: 0 0 10px var(--color-red-danger);
        }

        .dev-menu button:hover {
            background-color: var(--color-red-danger);
        }

        /* =================================
        == –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –í–•–û–î–£ 
        =================================
        */
        .modal {
            display: none; 
            position: fixed;
            z-index: 200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8); 
        }

        .modal-content {
            background-color: var(--color-black-light);
            margin: 15% auto; 
            padding: 20px;
            border: 1px solid var(--color-red-danger);
            width: 80%; 
            max-width: 300px;
            text-align: center;
            box-shadow: 0 0 20px rgba(204, 0, 0, 0.5);
        }

        .modal-content input {
            width: 90%;
            padding: 10px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid var(--color-border);
            box-sizing: border-box;
            background-color: var(--color-bg);
            color: var(--color-text);
        }

        .modal-content button {
            background-color: var(--color-red-dark);
            color: white;
            padding: 10px 15px;
            margin-top: 10px;
            border: none;
            cursor: pointer;
            width: 100%;
        }

        .modal-content button:hover {
            background-color: var(--color-red-danger);
        }

        /* =================================
        == –ü–û–ó–ò–¶–Ü–û–ù–£–í–ê–ù–ù–Ø –û–ë–õ–ê–°–¢–ï–ô (–Ü–ú–Ü–¢–ê–¶–Ü–Ø –ö–ê–†–¢–ò)
        =================================
        */
        #–ê–†–ö, #–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å { top: 85%; left: 50%; width: 10%; height: 10%; }
        #–í–æ–ª–∏–Ω—Å—å–∫–∞ { top: 5%; left: 10%; width: 10%; height: 15%; }
        #–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ { top: 40%; left: 30%; width: 10%; height: 15%; }
        #–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ { top: 45%; left: 60%; width: 15%; height: 15%; }
        #–î–æ–Ω–µ—Ü—å–∫–∞ { top: 40%; left: 80%; width: 15%; height: 15%; }
        #–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ { top: 20%; left: 35%; width: 10%; height: 15%; }
        #–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ { top: 40%; left: 0%; width: 8%; height: 10%; }
        #–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ { top: 60%; left: 65%; width: 15%; height: 15%; }
        #–Ü–≤–∞–Ω–æ–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ { top: 25%; left: 10%; width: 10%; height: 10%; }
        #–ö–∏—ó–≤, #–ö–∏—ó–≤—Å—å–∫–∞ { top: 25%; left: 45%; width: 10%; height: 15%; }
        #–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ { top: 55%; left: 50%; width: 10%; height: 15%; }
        #–õ—É–≥–∞–Ω—Å—å–∫–∞ { top: 25%; left: 80%; width: 15%; height: 15%; }
        #–õ—å–≤—ñ–≤—Å—å–∫–∞ { top: 15%; left: 10%; width: 10%; height: 10%; }
        #–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ { top: 70%; left: 40%; width: 10%; height: 15%; }
        #–û–¥–µ—Å—å–∫–∞ { top: 70%; left: 20%; width: 15%; height: 15%; }
        #–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ { top: 40%; left: 55%; width: 10%; height: 15%; }
        #–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ { top: 10%; left: 20%; width: 10%; height: 15%; }
        #–°—É–º—Å—å–∫–∞ { top: 15%; left: 60%; width: 10%; height: 15%; }
        #–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ { top: 25%; left: 20%; width: 10%; height: 15%; }
        #–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ { top: 25%; left: 70%; width: 10%; height: 15%; }
        #–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞ { top: 75%; left: 55%; width: 10%; height: 10%; }
        #–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ { top: 25%; left: 30%; width: 10%; height: 15%; }
        #–ß–µ—Ä–∫–∞—Å—å–∫–∞ { top: 45%; left: 45%; width: 10%; height: 15%; }
        #–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ { top: 40%; left: 15%; width: 8%; height: 10%; }
        #–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ { top: 5%; left: 45%; width: 10%; height: 15%; }

        /* –ü–æ–ø—Ä–∞–≤–∫–∏ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –≤–∏–≥–ª—è–¥—É –º—ñ—Å—Ç */
        #–ö–∏—ó–≤ { z-index: 30; background-color: #CC0000; border-radius: 50%; width: 30px; height: 30px; font-size: 8px; left: 47%; top: 30%;}
        #–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å { z-index: 30; background-color: #CC0000; border-radius: 50%; width: 25px; height: 25px; font-size: 8px; left: 51%; top: 88%;}
    </style>
</head>
<body>

    <div class="info-panel">
        <p id="status-message">üîÑ –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è...</p>
    </div>

    <button class="dev-login-btn" onclick="openLoginModal()">
        –£–≤—ñ–π—Ç–∏ —è–∫ –†–æ–∑—Ä–æ–±–Ω–∏–∫
    </button>

    <div class="map-container">
        <div id="–ê–†–ö" class="oblast">–ê–† –ö—Ä–∏–º</div>
        <div id="–í–æ–ª–∏–Ω—Å—å–∫–∞" class="oblast">–í–æ–ª–∏–Ω—Å—å–∫–∞</div>
        <div id="–í—ñ–Ω–Ω–∏—Ü—å–∫–∞" class="oblast">–í—ñ–Ω–Ω–∏—Ü—å–∫–∞</div>
        <div id="–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞" class="oblast">–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞</div>
        <div id="–î–æ–Ω–µ—Ü—å–∫–∞" class="oblast">–î–æ–Ω–µ—Ü—å–∫–∞</div>
        <div id="–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞" class="oblast">–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞</div>
        <div id="–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞" class="oblast">–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞</div>
        <div id="–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞" class="oblast">–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞</div>
        <div id="–Ü–≤–∞–Ω–æ–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞" class="oblast">–Ü–≤.-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞</div>
        <div id="–ö–∏—ó–≤" class="oblast">–ú. –ö–∏—ó–≤</div>
        <div id="–ö–∏—ó–≤—Å—å–∫–∞" class="oblast">–ö–∏—ó–≤—Å—å–∫–∞</div>
        <div id="–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞" class="oblast">–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞</div>
        <div id="–õ—É–≥–∞–Ω—Å—å–∫–∞" class="oblast">–õ—É–≥–∞–Ω—Å—å–∫–∞</div>
        <div id="–õ—å–≤—ñ–≤—Å—å–∫–∞" class="oblast">–õ—å–≤—ñ–≤—Å—å–∫–∞</div>
        <div id="–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞" class="oblast">–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞</div>
        <div id="–û–¥–µ—Å—å–∫–∞" class="oblast">–û–¥–µ—Å—å–∫–∞</div>
        <div id="–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞" class="oblast">–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞</div>
        <div id="–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞" class="oblast">–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞</div>
        <div id="–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å" class="oblast">–ú. –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å</div>
        <div id="–°—É–º—Å—å–∫–∞" class="oblast">–°—É–º—Å—å–∫–∞</div>
        <div id="–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞" class="oblast">–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞</div>
        <div id="–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞" class="oblast">–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞</div>
        <div id="–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞" class="oblast">–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞</div>
        <div id="–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞" class="oblast">–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞</div>
        <div id="–ß–µ—Ä–∫–∞—Å—å–∫–∞" class="oblast">–ß–µ—Ä–∫–∞—Å—å–∫–∞</div>
        <div id="–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞" class="oblast">–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞</div>
        <div id="–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞" class="oblast">–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞</div>
    </div>

    <div class="dev-menu" id="devMenu">
        <h3>üõ†Ô∏è –ú–µ–Ω—é –†–æ–∑—Ä–æ–±–Ω–∏–∫–∞: –†—É—á–Ω–µ –ö–µ—Ä—É–≤–∞–Ω–Ω—è –¢—Ä–∏–≤–æ–≥–æ—é (–Ü–º—ñ—Ç–∞—Ü—ñ—è)</h3>
        <p>–¶—ñ –∫–Ω–æ–ø–∫–∏ —ñ–º—ñ—Ç—É—é—Ç—å –≤–º–∏–∫–∞–Ω–Ω—è —Ç—Ä–∏–≤–æ–≥–∏. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ API –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å —Ä–æ–±–æ—Ç—É!**</p>
        <div class="controls" id="devControls">
            </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h4>–í—Ö—ñ–¥ –¥–ª—è –†–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤</h4>
            <input type="text" id="username" placeholder="–õ–æ–≥—ñ–Ω: admin">
            <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å: admin">
            <button onclick="login()">–£–≤—ñ–π—Ç–∏</button>
            <p id="login-message" style="color: var(--color-red-danger);"></p>
        </div>
    </div>

    <script>
        /* =================================
        == JAVASCRIPT –õ–û–ì–Ü–ö–ê –¢–ê –Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø XML API
        =================================
        */

        const API_URL = 'https://ubilling.net.ua/aerialalerts/?xml=true';
        const API_INTERVAL = 10000; // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥
        const statusMessage = document.getElementById('status-message');

        const oblasts = [
            "–ê–≤—Ç–æ–Ω–æ–º–Ω–∞ –†–µ—Å–ø—É–±–ª—ñ–∫–∞ –ö—Ä–∏–º", "–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–î–æ–Ω–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–º. –ö–∏—ó–≤", "–ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–õ—É–≥–∞–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–û–¥–µ—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–º. –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å", "–°—É–º—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", 
            "–ß–µ—Ä–∫–∞—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å", "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å"
        ];
        
        /**
         * –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –Ω–∞–∑–≤—É –æ–±–ª–∞—Å—Ç—ñ –∑ API —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π ID –µ–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç—ñ.
         */
        function createId(name) {
            if (!name) return '';
            const cleanName = name.trim();
            if (cleanName === "–ê–≤—Ç–æ–Ω–æ–º–Ω–∞ –†–µ—Å–ø—É–±–ª—ñ–∫–∞ –ö—Ä–∏–º") return "–ê–†–ö";
            if (cleanName === "–º. –ö–∏—ó–≤") return "–ö–∏—ó–≤";
            if (cleanName === "–º. –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å") return "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å";
            if (cleanName === "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å") return "–Ü–≤–∞–Ω–æ–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞";
            
            // –í–∏–¥–∞–ª—è—î–º–æ "–æ–±–ª–∞—Å—Ç—å" —Ç–∞ –ø—Ä–æ–±—ñ–ª–∏/–∫—Ä–∞–ø–∫–∏ –¥–ª—è ID
            return cleanName.replace(' –æ–±–ª–∞—Å—Ç—å', '').replace(/[\s\.\-]/g, '');
        }

        /**
         * –ü–∞—Ä—Å–∏—Ç—å XML-—Ä—è–¥–æ–∫ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤ –∑ –¥–∞–Ω–∏–º–∏ –ø—Ä–æ —Ç—Ä–∏–≤–æ–≥–∏.
         */
        function parseXmlAlerts(xmlString) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlString, "text/xml");
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–æ–º–∏–ª–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥—É XML
            if (xmlDoc.getElementsByTagName("parsererror").length) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É XML:", xmlDoc.getElementsByTagName("parsererror")[0].textContent);
                return null;
            }

            const alerts = [];
            
            // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ XML –º—ñ—Å—Ç–∏—Ç—å —Ç–µ–≥–∏ <item>
            const items = xmlDoc.getElementsByTagName('item'); 
            
            for (let item of items) {
                const regionElement = item.getElementsByTagName('region')[0];
                const alertElement = item.getElementsByTagName('alert')[0];
                const dateElement = item.getElementsByTagName('date')[0];

                if (regionElement && alertElement) {
                    const regionName = regionElement.textContent.trim();
                    // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ "1" –∞–±–æ "0" —É true/false
                    const isAlert = alertElement.textContent.trim() === '1'; 
                    const date = dateElement ? dateElement.textContent.trim() : 'N/A';

                    alerts.push({
                        region: regionName,
                        alert: isAlert,
                        date: date
                    });
                }
            }
            return alerts;
        }

        /**
         * –ù–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –¥–æ API —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –¥–∞–Ω—ñ.
         */
        async function getAlertsFromAPI() {
            try {
                statusMessage.textContent = 'üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...';
                
                const response = await fetch(API_URL);
                
                if (!response.ok) {
                    statusMessage.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞ API: HTTP ${response.status}`;
                    throw new Error(`–ü–æ–º–∏–ª–∫–∞ HTTP: ${response.status}`);
                }

                const xmlText = await response.text(); 
                const data = parseXmlAlerts(xmlText);
                
                if (data && data.length > 0) {
                    statusMessage.textContent = '‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –∑ API: ' + new Date().toLocaleTimeString();
                } else {
                    statusMessage.textContent = '‚ö†Ô∏è API –Ω–µ –ø–æ–≤–µ—Ä–Ω—É–ª–æ –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ç—Ä–∏–≤–æ–≥–∏.';
                }
                
                return data;
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö API:', error);
                statusMessage.textContent = '‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö (–º–æ–∂–ª–∏–≤–æ, CORS)';
                return null; 
            }
        }

        /**
         * –û–Ω–æ–≤–ª—é—î –≤–∏–≥–ª—è–¥ –∫–∞—Ä—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–∏—Ö API.
         */
        function updateMap(apiData) {
            if (!Array.isArray(apiData)) return;

            // 1. –°–ø–æ—á–∞—Ç–∫—É –≤–∏–º–∏–∫–∞—î–º–æ –≤—Å—ñ —Ç—Ä–∏–≤–æ–≥–∏
            oblasts.forEach(oblastName => {
                const id = createId(oblastName);
                const regionElement = document.getElementById(id);
                if (regionElement) {
                    regionElement.classList.remove('alert');
                }
            });

            // 2. –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ç—Ä–∏–≤–æ–≥—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ API
            apiData.forEach(item => {
                const regionId = createId(item.region); 
                const regionElement = document.getElementById(regionId);
                
                if (regionElement) {
                    if (item.alert === true) {
                        regionElement.classList.add('alert');
                    } 
                }
            });

            // 3. –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –∫–Ω–æ–ø–æ–∫ Dev Menu, —è–∫—â–æ –≤–æ–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–µ
            if (devMenu.style.display === 'block') {
                generateControls();
            }
        }

        /**
         * –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–ø—É—Å–∫—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
         */
        async function checkAndRefresh() {
            const data = await getAlertsFromAPI();
            
            if (data) {
                updateMap(data);
            }
        }

        // =================================
        // –õ–û–ì–Ü–ö–ê –í–•–û–î–£ –¢–ê –ú–ï–ù–Æ –†–û–ó–†–û–ë–ù–ò–ö–ê (–±–µ–∑ –∑–º—ñ–Ω)
        // =================================
        const modal = document.getElementById('loginModal');
        const devMenu = document.getElementById('devMenu');
        const loginBtn = document.querySelector('.dev-login-btn');
        const loginMessage = document.getElementById('login-message');
        const controlsContainer = document.getElementById('devControls');


        function generateControls() {
            controlsContainer.innerHTML = ''; 

            oblasts.forEach(oblastName => {
                const id = createId(oblastName);
                const shortName = id.replace('–ê–≤—Ç–æ–Ω–æ–º–Ω–∞–†–µ—Å–ø—É–±–ª—ñ–∫–∞', '–ê–†–ö');
                
                const button = document.createElement('button');
                button.id = `toggle-${id}`;
                
                const region = document.getElementById(id);
                const isAlertActive = region && region.classList.contains('alert');
                button.textContent = `${shortName} (${isAlertActive ? '–£–í–Ü–ú–ö' : '–í–∏–º–∫'})`;
                if (isAlertActive) button.classList.add('active-alert');

                button.onclick = () => toggleAlert(id, `toggle-${id}`); 
                
                controlsContainer.appendChild(button);
            });
        }

        function openLoginModal() {
            loginBtn.style.display = 'none'; 
            modal.style.display = 'block';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            loginMessage.textContent = '';
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'admin' && password === 'admin') {
                modal.style.display = 'none';
                devMenu.style.display = 'block'; 
                loginBtn.style.display = 'none';
                generateControls(); 
            } else {
                loginMessage.textContent = '–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å.';
                loginBtn.style.display = 'block'; 
            }
        }

        /**
         * –ü–µ—Ä–µ–º–∏–∫–∞—î —Å—Ç–∞–Ω —Ç—Ä–∏–≤–æ–≥–∏ (—Ä—É—á–Ω–∞ —ñ–º—ñ—Ç–∞—Ü—ñ—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–æ–º).
         */
        function toggleAlert(regionId, buttonId) {
            const region = document.getElementById(regionId);
            const button = document.getElementById(buttonId);
            
            if (!region || !button) return;

            const isAlertActive = region.classList.contains('alert');
            const regionName = button.textContent.split(' ')[0];

            if (isAlertActive) {
                region.classList.remove('alert');
                button.classList.remove('active-alert');
                button.textContent = `${regionName} (–í–∏–º–∫)`;
            } else {
                region.classList.add('alert');
                button.classList.add('active-alert');
                button.textContent = `${regionName} (–£–í–Ü–ú–ö)`;
            }
            
            console.log(`[DEV MENU] –†–µ–≥—ñ–æ–Ω ${regionName} - –¢—Ä–∏–≤–æ–≥–∞: ${!isAlertActive ? '–£–í–Ü–ú–ö–ù–ï–ù–û (–†—É—á–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è)' : '–í–ò–ú–ö–ù–ï–ù–û (–†—É—á–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è)'}`);
        }

        // =================================
        // –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø
        // =================================

        // 1. –ü–µ—Ä—à–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        checkAndRefresh(); 
        setInterval(checkAndRefresh, API_INTERVAL); 

    </script>
</body>
</html>